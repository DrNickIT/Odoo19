<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_consignment_submission_search" model="ir.ui.view">
        <field name="name">consignment.submission.search</field>
        <field name="model">otters.consignment.submission</field>
        <field name="arch" type="xml">
            <search string="Zoek Inzendingen">
                <field name="name"/>
                <field name="supplier_id"/>
                <field name="x_submission_year"/>

                <separator/>
                <filter string="Nieuw" name="status_draft" domain="[('state', '=', 'draft')]"/>
                <filter string="Online" name="status_online" domain="[('state', '=', 'online')]"/>
                <separator/>

                <filter string="Leverancier" name="group_supplier" context="{'group_by': 'supplier_id'}"/>
                <filter string="Jaar" name="group_year" context="{'group_by': 'x_submission_year'}"/>
                <filter string="Status" name="group_state" context="{'group_by': 'state'}"/>
            </search>
        </field>
    </record>

    <record id="view_consignment_submission_list" model="ir.ui.view">
        <field name="name">consignment.submission.list</field>
        <field name="model">otters.consignment.submission</field>
        <field name="arch" type="xml">
            <list>
                <field name="name"/>
                <field name="supplier_id"/>

                <field name="x_submission_year" optional="show" widget="char"/>

                <field name="submission_date"/>
                <field name="payout_method"/>
                <field name="payout_percentage" widget="percentage"/>
                <field name="state" widget="badge"/>
                <field name="product_count" sum="Totaal Stuks" string="Aantal OK"/>
                <field name="rejected_count" sum="Totaal Geweigerd" string="Geweigerd" optional="show" decoration-danger="rejected_count > 0"/>
            </list>
        </field>
    </record>

    <record id="view_consignment_product_simple_form" model="ir.ui.view">
        <field name="name">consignment.product.simple.form</field>
        <field name="model">product.template</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <field name="image_1920" widget="image" class="oe_avatar"/>
                        <group>
                            <field name="name" required="1"/>
                            <field name="is_storable" string="Voorraad bijhouden"/>
                            <field name="qty_available" string="Aanwezige Voorraad"
                                   invisible="not is_storable"/>
                            <field name="public_categ_ids" widget="many2many_tags"/>
                            <field name="list_price"/>
                        </group>
                    </group>
                    <notebook>

                        <page string="Kenmerken (Geslacht, Seizoen, etc.)">
                            <field name="attribute_line_ids">
                                <list editable="bottom">
                                    <field name="attribute_id" required="1"/>
                                    <field name="value_ids" widget="many2many_tags"
                                           options="{'no_create_edit': True}"
                                           domain="[('attribute_id', '=', attribute_id)]"
                                           string="Waarden"/>
                                </list>
                            </field>
                            <p class="text-muted">
                                Gebruik dit om kenmerken (zoals Geslacht of Seizoen) toe te wijzen.
                            </p>
                        </page>

                        <page string="Extra Afbeeldingen">
                            <field name="product_template_image_ids">
                                <list editable="bottom">
                                    <field name="name"/>
                                    <field name="image_1920" widget="image" options="{'size': [50, 50]}"/>
                                </list>
                            </field>
                        </page>

                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_consignment_submission_form" model="ir.ui.view">
        <field name="name">consignment.submission.form</field>
        <field name="model">otters.consignment.submission</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="%(action_import_products_wizard)d" string="Importeer Producten (CSV)" type="action" class="oe_highlight"/>
                    <button name="action_generate_sendcloud_label" string="Maak Verzendlabel" type="object" class="btn-secondary"/>
                    <button name="action_lock_contract" string="Vergrendel Contract" type="object" invisible="x_is_locked"/>
                    <button name="action_unlock_contract"
                            string="Contract Wijzigen (Unlock)"
                            type="object"
                            invisible="not x_is_locked"
                            confirm="OPGELET! &#10;&#10;Als u het percentage wijzigt, worden de commissies voor REEDS VERKOCHTE artikelen met terugwerkende kracht herberekend!&#10;&#10;De klant zal dus andere bedragen zien in zijn portaal voor items die al verkocht zijn.&#10;&#10;Bent u zeker dat u wilt doorgaan?"
                    />
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" icon="fa-shirtsinbulk" disabled="1">
                            <field name="product_count" widget="statinfo" string="Producten"/>
                        </button>

                        <button class="oe_stat_button" icon="fa-ban" disabled="1">
                            <field name="rejected_count" widget="statinfo" string="Geweigerd"/>
                        </button>
                    </div>
                    <widget name="web_ribbon" title="Contract Vast" bg_color="text-bg-danger" invisible="not x_is_locked"/>
                    <div class="oe_title">
                        <h1><field name="name" readonly="1"/></h1>
                    </div>
                    <group>
                        <group string="Inzending Details">
                            <field name="supplier_id"/>
                            <field name="submission_date"/>

                            <field name="x_submission_year" readonly="1" widget="char"/>

                            <field name="state"/>
                            <field name="label_count" string="Aangevraagde Labels"/>
                        </group>
                        <group string="Uitbetaling">
                            <field name="x_is_locked" invisible="1"/>
                            <field name="payout_method" readonly="x_is_locked"/>
                            <field name="payout_percentage" readonly="x_is_locked"/>
                            <field name="x_iban" invisible="payout_method != 'cash'"/>
                        </group>
                        <group string="Geaccepteerde Voorwaarden">
                            <field name="agreed_to_terms" readonly="1"/>
                            <field name="agreed_to_clothing_terms" readonly="1"/>
                            <field name="agreed_to_shipping_fee" readonly="1"/>
                        </group>
                        <group string="Keuzes bij niet geaccepteerd/verkocht">
                            <field name="action_unaccepted"/>
                            <field name="action_unsold"/>
                        </group>
                    </group>
                    <group string="Verzendlabels" invisible="not label_ids">
                        <field name="label_ids" nolabel="1">
                            <list editable="bottom" create="0" delete="0">
                                <field name="tracking_number"/>
                                <field name="label_url" widget="url" text="Download Label"/>
                                <button name="action_open_url" type="object" icon="fa-external-link" title="Open Label"/>
                            </list>
                        </field>
                    </group>
                    <notebook>
                        <page string="Producten">
                            <field name="product_ids" context="{'default_is_published': True}">
                                <list>
                                    <field name="name"/>
                                    <field name="default_code" optional="show"/>
                                    <field name="public_categ_ids" widget="many2many_tags" optional="hide"/>
                                    <field name="list_price"/>
                                    <field name="qty_available" string="Voorraad"/>
                                    <field name="is_published" string="Online"/>
                                </list>
                            </field>
                        </page>
                        <page string="Niet Weerhouden producten">
                            <field name="rejected_line_ids">
                                <list editable="bottom">
                                    <field name="product_name"/>
                                    <field name="reason"/>
                                    <field name="note" optional="show"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <chatter />
            </form>
        </field>
    </record>

    <record id="action_consignment_submission" model="ir.actions.act_window">
        <field name="name">Inzendingen</field>
        <field name="res_model">otters.consignment.submission</field>
        <field name="view_mode">list,form</field>
        <field name="search_view_id" ref="view_consignment_submission_search"/>
    </record>

    <menuitem id="menu_consignment_root" name="Verzendlabels" sequence="10"/>
    <menuitem id="menu_consignment_submission" name="Inzendingen" parent="otters_consignment.menu_consignment_root" action="action_consignment_submission" sequence="10"/>
</odoo>